{% extends "FulldonIntersaBundle::coque_intersa.html.twig" %}
{% block stylesheets %}
    {{ parent() }}
    {% stylesheets '../app/Resources/Public/css/global/jquery-ui/*' %}
    <link rel="stylesheet" type="text/css" charset="UTF-8" media="all" href="{{ asset_url }}"/>
    {% endstylesheets %}
{% endblock %}
{% block coque_intersa %}
    <div class="breadcrumbs" id="breadcrumbs">
        <script type="text/javascript">
            try {
                ace.settings.check('breadcrumbs', 'fixed')
            } catch (e) {
            }
        </script>
        <ol class="breadcrumb">
            <li><a href="{{ path('fulldon_intersa_homepage') }}">Accueil</a></li>
            <li class="active">Gestion des donateurs</li>
        </ol>
    </div>
    <div class="page-content">

        <!-- PAGE CONTENT BEGINS -->
        <div class="page-header">
            <h1>
                Gestion des donateurs
                <small>
                    <i class="ace-icon fa fa-angle-double-right"></i>
                    Recherche avancée
                </small>
            </h1>
        </div>
        <!-- /.page-header -->

        <div class="alert alert-success" id="msg_success" style="display: none">
        </div>  

        <div class="alert alert-warning" id="msg_erreur" style="display: none">
        </div>

        <div class="alert alert-info" id="msg_info" style="display: none">
        </div>


        {% for flashMessage in app.session.flashbag.get('info') %}
            <div class="alert alert-info">
                {{ flashMessage }}
            </div>
        {% endfor %}
        {% for flashMessage in app.session.flashbag.get('warning') %}
            <div class="alert alert-warning" id="msg_warning">
                {{ flashMessage }}
            </div>
        {% endfor %}
        {% for flashMessage in app.session.flashbag.get('success') %}
            <div class="alert alert-success" >
                {{ flashMessage }}
            </div>
        {% endfor %}
        {% for flashMessage in app.session.flashbag.get('erreur') %}
            <div class="alert alert-danger" >
                {{ flashMessage }}
            </div>
        {% endfor %}


        <div class="pull-right" id="nbr_donateur">
            {% if last_page >= 1 %}
                <div class="pagination_desc"><strong>{{ total_donateur }}</strong> Donateur(s)
                </div>
            {% endif %}
        </div>

        <!--form action="{#{ path('elastic_donateur') }#}" method="get" class="form-group"
              onsubmit="show_result()" {#{ form_enctype(form) }#}-->

        {#% set total_don = 0 %#}
        <form action="{{ path('elastic_donateur') }}" method="get" class="form-group"
              {{ form_enctype(form) }}>
            <ul class="nav nav-tabs">
                <li  id="li_recherche_formulaire" {% if total_donateur == 0  %}class="active"{% endif %} ><a href="#recherche" data-toggle="tab">Recherche</a>
                </li>

                <li id="li_result_rechreche_de">
                    <a href="#result_search_de" data-toggle="tab">DE sauvegardés</a>
                    <!--input type="hidden" id="active_desactive_don" value="{#{total_don}#}" /-->
                </li>
                <li  id="li_result_recherche_donateur" {% if total_donateur > 0 %}class="active"{% endif %}><a href="#result" data-toggle="tab">Resultat de
                        recherche</a></li>
                     <!--li {#% if total_don > 0 %#}class="active"{#% endif %#}-->
                <li id="li_result_rechreche_don">
                    <a href="#result_search_don" data-toggle="tab">Recherche par don</a>


            </ul>
            <div class="widget-toolbox padding-8 clearfix">
                <div class="pull-left">
                    {% if is_granted('ROLE_INTERSA_N1') or is_granted('ROLE_ASSOC_N1') or is_granted('ROLE_TRIAL') %}

                        <a href="{{ path('intersa_donateur_add') }}" class="btn btn-success btn-sm"  id="add_donateur"><span
                                class="fa fa-plus"></span> Ajouter un donateur </a>



                        {% if result is not empty %}

                            <div class="btn-group" style="margin-right: 20px;">
                                <button type="button" class="btn btn-warning dropdown-toggle btn-sm" data-toggle="dropdown"
                                        aria-expanded="false" id="gestion_favoris_donateur">
                                    <i class="fa fa-star"></i> Gestion des favoris <i
                                        class="ace-icon fa fa-angle-down icon-on-right"></i>
                                </button>
                                <ul class="dropdown-menu" role="menu">

                                    <li><a data-toggle="modal" data-target="#addRecherche" href="#"><i class="fa fa-plus"></i>
                                            Ajouter cette recherche aux favoris</a></li>

                                    <li><a data-toggle="modal" data-target="#addSauvgardeCritere" href="#"><i class="fa fa-plus"></i>
                                            Ajouter cette selection</a></li>
                                    <li><a data-toggle="modal" data-target="#listRecherche" href="#"><i class="fa fa-list"></i>
                                            Afficher les recherches favorites</a></li>

                                    <li id="li_donateur_exel">
                                        <a href="{#{ path('intersa_gestion_donateur_export_exel') }#}"  id="btn_generate_donateur_exel" >
                                            <i class="fa fa-file-archive-o"></i> Exporter les donateurs  en Excel
                                        </a>
                                    </li>

                                    <li id="li_donateur_exel2">
                                        <a href="{{ path('download_donateur_export_exel') }}"  id="btn_generate_donateur_exel2" target="_blank" >
                                            <i class="fa fa-file-archive-o"></i> Télécharger les donateurs  en Excel
                                        </a>
                                    </li>

                                </ul>
                            </div>
                            <br>


                        {% else %}

                            <div class="btn-group " style="margin-right: 20px;">
                                <button type="button" class="btn btn-warning dropdown-toggle btn-sm" data-toggle="dropdown"
                                        aria-expanded="false">
                                    <i class="fa fa-star"></i> Gestion des favoris <i
                                        class="ace-icon fa fa-angle-down icon-on-right"></i>
                                </button>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a data-toggle="modal" data-target="#listRecherche" href="#"><i class="fa fa-list"></i>
                                            Afficher les recherches favorites</a></li>
                                            {#<li><a href="#"><i class="fa fa-file-excel-o"></i> Export excel</a></li>#}
                                            {#<li><a href="#"><i class="fa fa-file-pdf-o"></i> Export pdf</a></li>#}
                                </ul>
                            </div>

                        {% endif %}
                    {% endif %}
                </div>





                <div class="miftah-form" id="div_description">
                    <div class="element"
                         style="background-color: #F78D1E;float:left;margin-right:5px;border: 1px solid #000;"></div>
                    <div style="float:left;margin-right:10px;">Champs inclus dans le résultat</div><br />
                    <div class="element"
                         style="background-color: #393939;float:left;margin-right:5px;border: 1px solid #000;"></div>
                    <div style="float:left;margin-right:10px;">Champs non inclus dans le résultat</div>
                </div>

                <button class="btn btn-xs btn-success pull-right" type="submit" id="serach_btn_elastic_donateur">
                    <span class="bigger-110">Rechercher</span>

                    <i class="ace-icon fa fa-search icon-on-right"></i>
                </button>

                <!--button class="btn btn-xs btn-success pull-right" type="button" id="serach_btn_elastic_don" style="display: none">
                    <span class="bigger-110">Rechercher</span>

                    <i class="ace-icon fa fa-search icon-on-right"></i>
                </button-->
                <button class="btn btn-xs btn-default pull-right" type="reset" id="reset_elastic_donateur">
                    <span class="bigger-110">Réinitialiser </span>

                    <i class="ace-icon fa fa-remove icon-on-right"></i>
                </button>
            </div>
            <!-- Tab panes -->
            <div class="tab-content" id="main_tab_content">
                <div class="tab-pane {% if total_donateur == 0  %}active{% endif %}" id="recherche">
                    <br/>


                    <div class="row">
                        <div class="col-xs-12 col-sm-5">
                            <div class="widget-box">
                                <div class="widget-header">
                                    <h4 class="widget-title title-plus">Informations générales</h4>


                                </div>

                                <div class="widget-body">
                                    <div class="widget-main">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label for="inputEmail3"
                                                       class="control-label">{{ form_label(form.refDonateur, "N° donateur") }}</label>

                                                <div>
                                                    {{ form_widget(form.refDonateur, {'attr': {'class': 'task_field form-control', 'id':'nom', 'placeholder':'Identifiant' } }) }}
                                                </div>
                                            </div>
                                            <div class="col-md-6" >
                                                <label for="inputEmail3"
                                                       class=" control-label">{{ form_label(form.civilite, "Civilité") }}</label>

                                                <div>
                                                    {# Affichage des erreurs pour ce champ précis. #}
                                                    {{ form_errors(form.civilite) }}

                                                    {# Génération de l'input. #}
                                                    {{ form_widget(form.civilite, {'attr': {'class': 'task_field form-control input-sm', 'id':'civilite'} }) }}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label for="inputEmail3" class=" control-label">{{ form_label(form.nom, "Nom") }}  </label>

                                                <div>
                                                    {% if form.nom.vars.errors|length %}
                                                        {# Affichage des erreurs pour ce champ précis. #}
                                                        <div class="form-group has-error">
                                                            <label class="control-label"
                                                                   for="inputError"> {{ form_errors(form.nom) }}</label>
                                                            {{ form_widget(form.nom, {'attr': {'class': 'task_field form-control input-sm', 'id':'inputError', 'placeholder':'Nom' } }) }}
                                                        </div>
                                                    {% else %}
                                                        {# Génération de l'input. #}
                                                        {{ form_widget(form.nom, {'attr': {'class': 'task_field form-control input-sm', 'id':'nom', 'placeholder':'Nom' } }) }}
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="inputEmail3"
                                                       class=" control-label">{{ form_label(form.prenom, "Prénom") }}</label>

                                                <div>
                                                    {% if form.prenom.vars.errors|length %}
                                                        {# Affichage des erreurs pour ce champ précis. #}
                                                        <div class="form-group has-error">
                                                            <label class="control-label"
                                                                   for="inputError"> {{ form_errors(form.prenom) }}</label>
                                                            {{ form_widget(form.prenom, {'attr': {'class': 'task_field form-control input-sm', 'id':'prenom', 'placeholder':'Prénom' } }) }}
                                                        </div>
                                                    {% else %}
                                                        {# Génération de l'input. #}
                                                        {{ form_widget(form.prenom, {'attr': {'class': 'task_field form-control input-sm', 'id':'prenom', 'placeholder':'Prénom' } }) }}
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6" >
                                                <label for="inputEmail3"
                                                       class=" control-label">{{ form_label(form.dateNaissance, "Date de naissance") }}</label>

                                                <div>
                                                    {% if form.dateNaissance.vars.errors|length %}
                                                        {# Affichage des erreurs pour ce champ précis. #}
                                                        <div class="form-group has-error">
                                                            <label class="control-label"
                                                                   for="inputError"> {{ form_errors(form.date_naissance) }}</label>
                                                            {{ form_widget(form.dateNaissance, {'attr': { 'id':'dateNaissance', 'placeholder':'jj/mm/aaaa', 'class': 'task_field form-control input-sm' } }) }}
                                                        </div>
                                                    {% else %}
                                                        {# Génération de l'input. #}
                                                        {{ form_widget(form.dateNaissance, {'attr': { 'id':'nom', 'placeholder':'jj/mm/aaaa', 'class': 'task_field form-control input-sm' } }) }}
                                                    {% endif %}
                                                </div>
                                            </div>

                                            <div class="col-md-6" >
                                                <label for="inputEmail3"
                                                       class="control-label">{{ form_label(form.nom, "Nom Entreprise") }}</label>

                                                <div>
                                                    {{ form_widget(form.nomEntreprise, {'attr': {'class': 'task_field form-control', 'id':'nom_entreprise', 'placeholder':'Nom Entreprise' } }) }}
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <label class=" control-label">{{ form_label(form.email, "Email") }}</label>

                                            <div>
                                                {{ form_widget(form.email, {'attr': { 'class': 'task_field form-control', 'id':'email'} }) }}
                                            </div>
                                            <div id="div_message_error_mail" style="display: none"></div>
                                        </div>
                                        <div>
                                            <label for="inputEmail3"
                                                   class=" control-label">{{ form_label(form.categories, "Catégorie") }}</label>
                                            <div class="form-group col-md-12">


                                            </div>
                                            <div  id="cat_list">
                                                {# Affichage des erreurs pour ce champ précis. #}
                                                {{ form_errors(form.categories) }}

                                                {# Génération de l'input. #}
                                                {{ form_widget(form.categories, {'attr': { 'class': 'task_field form-control input-sm', 'id':'cat_don'} }) }}
                                            </div>
                                        </div>

                                        <div >
                                            <label for="inputEmail3" class="col-sm-5 control-label">Filtre par type de PND : </label>

                                            <div >
                                                <select name="pnd" class="task_field form-control">
                                                    <option value=""></option>
                                                    <option value="npai1"> NPAI1</option>
                                                    <option value="npai2"> NPAI2</option>
                                                    <option value="npai3"> NPAI3</option>
                                                    <option value="refuse1"> Refusé 1</option>
                                                    <option value="refuse2"> Refusé 2</option>
                                                    <option value="refuse3"> Refusé 3</option>
                                                    <option value="decede"> Décédé</option>
                                                </select>
                                            </div>
                                        </div>
                                        <br />


                                        <label> Exceptions : </label><br />
                                        <div class="row">
                                            <div class=" col-md-6">
                                                <div class="form-group ">
                                                    <label class=" control-label">Paramètres email</label>

                                                    <div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="withemail" id="withemailyes" value="true" {% if memo_search['withemail'] == 'true' %} checked {% endif %}>
                                                                Avec
                                                            </label>
                                                        </div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="withemail" id="withemailno" value="false" {% if memo_search['withemail'] == 'false' %} checked {% endif %}>
                                                                Sans
                                                            </label>
                                                        </div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="withemail" id="withemailind" value="ind" >
                                                                indifférent
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class=" col-md-6">
                                                <div class="form-group ">
                                                    <label class=" control-label">Paramètres téléphone</label>

                                                    <div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="withtel" id="withtelyes" value="true" {% if memo_search['withtel'] == 'true' %} checked {% endif %} >
                                                                Avec
                                                            </label>
                                                        </div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="withtel" id="withtelno" value="false" {% if memo_search['withtel'] == 'false' %} checked {% endif %}>
                                                                Sans
                                                            </label>
                                                        </div>

                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="withtel" id="withtelind" value="ind" >
                                                                indifférent
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group ">
                                                    <label class=" control-label">Paramètres catégorie</label>

                                                    <div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="withcat" id="withcat" value="true" {% if memo_search['withcat'] == 'true' %} checked {% endif %} >
                                                                Avec
                                                            </label>
                                                        </div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="withcat" id="withcat" value="false" {% if memo_search['withcat'] == 'false' %} checked {% endif %}>
                                                                Sans
                                                            </label>
                                                        </div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="withcat" id="withcatlind" value="ind" >
                                                                indifférent
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group ">
                                                    <label class=" control-label">Statut du donateur</label>

                                                    <div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="statut_donateur" id="std1" value="on" {% if memo_search['statut_donateur'] == 'on' %} checked {% endif %}>
                                                                activé
                                                            </label>
                                                        </div>
                                                        <div class="radio-inline">
                                                            <label>
                                                                <input type="radio" name="statut_donateur" id="std2" value="off" {% if memo_search['statut_donateur'] == 'off' %} checked {% endif %}>
                                                                désactivé
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <br />
                                        <div>
                                            {{ form_errors(form.allowRf) }}

                                            {# Génération de l'input. #}
                                            {{ form_widget(form.allowRf, {'attr': {'class': ' checkbox-inline', 'id':'active'} }) }}{{ form_label(form.allowRf, "Donateurs souhaitent recevoir les reçus fiscaux ? ") }}
                                            <br/>

                                        </div>

                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- /.span -->

                        <div class="col-xs-12 col-sm-5">
                            <div class="widget-box">
                                <div class="widget-header">
                                    <h4 class="widget-title title-plus">Adresse postale</h4>

                                </div>

                                <div class="widget-body">
                                    <div class="widget-main">

                                        <div>
                                            <label for="inputEmail3"
                                                   class=" label-plus">{{ form_label(form.isopays, "Pays") }}</label>

                                            <div>
                                                {# Affichage des erreurs pour ce champ précis. #}
                                                {{ form_errors(form.isopays) }}

                                                {# Génération de l'input. #}
                                                {{ form_widget(form.isopays, {'attr': { 'class': 'task_field form-control input-sm', 'id':'pays'} }) }}
                                            </div>
                                        </div>
                                        <div>
                                            <label for="inputEmail3"
                                                   class=" label-plus">{{ form_label(form.zipcode, "Code postal ") }}</label>

                                            <div>
                                                {% if form.zipcode.vars.errors|length %}
                                                    {# Affichage des erreurs pour ce champ précis. #}
                                                    <div class="form-group has-error">
                                                        <label class="label-plus"
                                                               for="inputError"> {{ form_errors(form.zipcode) }}</label>
                                                        {{ form_widget(form.zipcode, {'attr': { 'class': 'task_field form-control', 'id':'codepostal'} }) }}
                                                    </div>
                                                {% else %}
                                                    {# Génération de l'input. #}
                                                    {{ form_widget(form.zipcode, {'attr': { 'class': 'task_field form-control', 'id':'zipcode'} }) }}
                                                {% endif %}

                                            </div>
                                        </div>
                                        <div>
                                            <label for="inputEmail3"
                                                   class=" label-plus">{{ form_label(form.isoville, "Ville") }}</label>

                                            <div>
                                                {# Affichage des erreurs pour ce champ précis. #}
                                                {{ form_errors(form.isoville) }}

                                                {# Génération de l'input. #}
                                                {{ form_widget(form.isoville, {'attr': { 'class': 'task_field form-control', 'id':'ville'} }) }}
                                            </div>
                                        </div>


                                        <div>
                                            <label for="inputEmail3"
                                                   class=" label-plus">{{ form_label(form.adresse3, "Numéro + libellé de la voie (rue, avenue...) ") }}</label>
                                            <div>
                                                {% if form.adresse3.vars.errors|length %}
                                                    {# Affichage des erreurs pour ce champ précis. #}
                                                    <div class="form-group has-error">
                                                        <label class="label-plus"
                                                               for="inputError"> {{ form_errors(form.adresse3) }}</label>
                                                        {{ form_widget(form.adresse3, {'attr': { 'class': 'task_field form-control', 'id':'adresse3'} }) }}
                                                    </div>
                                                {% else %}
                                                    {# Génération de l'input. #}
                                                    {{ form_widget(form.adresse3, {'attr': { 'class': 'task_field form-control', 'id':'adresse3'} }) }}
                                                {% endif %}
                                            </div>
                                        </div>

                                        <div>
                                            <label for="inputEmail3"
                                                   class=" label-plus">{{ form_label(form.adresse1, "N° appartement ou boîte aux lettres - étage - couloir - escalier ") }}</label>

                                            <div>
                                                {% if form.adresse1.vars.errors|length %}
                                                    {# Affichage des erreurs pour ce champ précis. #}
                                                    <div class="form-group has-error">
                                                        <label class="label-plus"
                                                               for="inputError"> {{ form_errors(form.adresse1) }}</label>
                                                        {{ form_widget(form.adresse1, {'attr': { 'class': 'task_field form-control', 'id':'adresse1'} }) }}
                                                    </div>
                                                {% else %}
                                                    {# Génération de l'input. #}
                                                    {{ form_widget(form.adresse1, {'attr': { 'class': 'task_field form-control', 'id':'adresse1'} }) }}
                                                {% endif %}
                                            </div>
                                        </div>
                                        <div>
                                            <label for="inputEmail3"
                                                   class=" label-plus">{{ form_label(form.adresse2, "Entrée - bâtiment - immeuble - résidence ") }}</label>

                                            <div>
                                                {% if form.adresse2.vars.errors|length %}
                                                    {# Affichage des erreurs pour ce champ précis. #}
                                                    <div class="form-group has-error">
                                                        <label class="label-plus"
                                                               for="inputError"> {{ form_errors(form.adresse2) }}</label>
                                                        {{ form_widget(form.adresse2, {'attr': { 'class': 'task_field form-control', 'id':'adresse2'} }) }}
                                                    </div>
                                                {% else %}
                                                    {# Génération de l'input. #}
                                                    {{ form_widget(form.adresse2, {'attr': { 'class': 'task_field form-control', 'id':'adresse2'} }) }}
                                                {% endif %}
                                            </div>
                                        </div>


                                        <div>
                                            <label for="inputEmail3"
                                                   class=" label-plus">{{ form_label(form.adresse4, "BP - Lieu dit ") }}</label>

                                            <div>
                                                {% if form.adresse4.vars.errors|length %}
                                                    {# Affichage des erreurs pour ce champ précis. #}
                                                    <div class="form-group has-error">
                                                        <label class="label-plus"
                                                               for="inputError"> {{ form_errors(form.adresse4) }}</label>
                                                        {{ form_widget(form.adresse4, {'attr': { 'class': 'task_field form-control', 'id':'adresse4'} }) }}
                                                    </div>
                                                {% else %}
                                                    {# Génération de l'input. #}
                                                    {{ form_widget(form.adresse4, {'attr': { 'class': 'task_field form-control', 'id':'adresse4'} }) }}
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- /.span -->

                        <div class="col-xs-12 col-sm-2">
                            <div class="widget-box">
                                <div class="widget-header">
                                    <h4 class="widget-title title-plus">Champs</h4>

                                </div>

                                <div class="widget-body no-overflow" >
                                    <div class="widget-main">

                                        <input type="hidden" name="columns" id="columns"
                                               value="{% if columns is not null  %}{{ columns }}{% endif %}"/>
                                        <div style="height:250px;" class="row">
                                            <div class="col-md-12">
                                                <ul id="sortable2" class="connectedSortable maincol" >

                                                    {% for col in col_display %}
                                                        {% if col == "numdonateur" %}
                                                            <li id="list_numdonateur" class="ui-state-highlight"><i class="fa fa-cube"></i> <b>Numéro du donateur</b>
                                                            </li>
                                                        {% elseif col ==  "nom" %}
                                                            <li id="list_nom" class="ui-state-highlight"><i class="fa fa-cube"></i> <b>Nom </b>
                                                            </li>
                                                        {% elseif col == "prenom" %}
                                                            <li id="list_prenom" class="ui-state-highlight"><i class="fa fa-cube"></i> <b> Prénom </b>
                                                            </li>
                                                        {% elseif col == "statut" %}
                                                            <li id="list_statut" class="ui-state-highlight"><i
                                                                    class="fa fa-cube"></i> <b>Statut</b>
                                                            </li>
                                                        {% elseif col == "nomentreprise" %}
                                                            <li id="list_nomentreprise" class="ui-state-highlight"><i class="fa fa-cube"></i> <b>Nom d'entreprise</b>
                                                            </li>
                                                        {% elseif col == "email" %}
                                                            <li id="list_email" class="ui-state-highlight"><i class="fa fa-cube"></i> <b>Email</b>
                                                            </li>
                                                        {% elseif col == "birthday" %}
                                                            <li id="list_birthday" class="ui-state-highlight"><i class="fa fa-cube"></i>
                                                                <b>Date de naissance </b>
                                                            </li>
                                                        {% elseif col == "telmobile" %}
                                                            <li id="list_telmobile" class="ui-state-highlight"><i
                                                                    class="fa fa-cube"></i> <b>Téléphone mobile</b>
                                                            </li>
                                                        {% elseif col == "telfixe" %}
                                                            <li id="list_telfixe" class="ui-state-highlight"><i class="fa fa-cube"></i>
                                                                <b>Téléphone fixe</b>
                                                            </li>
                                                        {% elseif col == "cat" %}
                                                            <li id="list_cat" class="ui-state-highlight"><i
                                                                    class="fa fa-cube"></i> <b>Catégories</b>
                                                            </li>
                                                        {% elseif col == "adresse" %}
                                                            <li id="list_adresse" class="ui-state-highlight"><i
                                                                    class="fa fa-cube"></i> <b>Adresse</b>
                                                            </li>
                                                        {% elseif col == "cumuldon" %}
                                                            <li id="list_cumuldon" class="ui-state-highlight"><i
                                                                    class="fa fa-cube"></i> <b>Cumul des dons</b>
                                                            </li>
                                                        {% elseif col == "ville" %}
                                                            <li id="list_ville" class="ui-state-highlight"><i
                                                                    class="fa fa-cube"></i> <b>Ville</b>
                                                            </li>
                                                        {% elseif col == "pays" %}
                                                            <li id="list_pays" class="ui-state-highlight"><i class="fa fa-cube"></i>
                                                                <b>Pays</b>
                                                            </li>
                                                        {% elseif col == "zipcode" %}

                                                            <li id="list_zipcode" class="ui-state-highlight"><i class="fa fa-cube"></i>
                                                                <b>Code postal</b>
                                                            </li>
                                                        {% elseif col == "createdat" %}
                                                            <li id="list_createdat" class="ui-state-highlight"><i class="fa fa-cube"></i>
                                                                <b>Date de creation </b>
                                                            </li>
                                                        {% endif %}
                                                    {% endfor %}







                                                </ul>
                                            </div>
                                            <div class="col-md-12" id="main_sortable1">
                                                <ul id="sortable1" class="connectedSortable">

                                                    {% for col in rest_cols %}
                                                        {% if col == "numdonateur" %}
                                                            <li id="list_numdonateur" class="ui-state-default"><i class="fa fa-cube"></i> <b>Numéro du donateur</b>
                                                            </li>
                                                        {% elseif col ==  "nom" %}
                                                            <li id="list_nom" class="ui-state-default"><i class="fa fa-cube"></i> <b>Nom </b>
                                                            </li>
                                                        {% elseif col == "prenom" %}
                                                            <li id="list_prenom" class="ui-state-default"><i class="fa fa-cube"></i> <b> Prénom </b>
                                                            </li>
                                                        {% elseif col == "statut" %}
                                                            <li id="list_statut" class="ui-state-default"><i
                                                                    class="fa fa-cube"></i> <b>Statut</b>
                                                            </li>
                                                        {% elseif col == "nomentreprise" %}
                                                            <li id="list_nomentreprise" class="ui-state-default"><i class="fa fa-cube"></i> <b>Nom d'entreprise</b>
                                                            </li>
                                                        {% elseif col == "email" %}
                                                            <li id="list_email" class="ui-state-default"><i class="fa fa-cube"></i> <b>Email</b>
                                                            </li>
                                                        {% elseif col == "birthday" %}
                                                            <li id="list_birthday" class="ui-state-default"><i class="fa fa-cube"></i>
                                                                <b>Date de naissance </b>
                                                            </li>
                                                        {% elseif col == "telmobile" %}
                                                            <li id="list_telmobile" class="ui-state-default"><i
                                                                    class="fa fa-cube"></i> <b>Téléphone mobile</b>
                                                            </li>
                                                        {% elseif col == "telfixe" %}
                                                            <li id="list_telfixe" class="ui-state-default"><i class="fa fa-cube"></i>
                                                                <b>Téléphone fixe</b>
                                                            </li>
                                                        {% elseif col == "cat" %}
                                                            <li id="list_cat" class="ui-state-default"><i
                                                                    class="fa fa-cube"></i> <b>Catégories</b>
                                                            </li>
                                                        {% elseif col == "adresse" %}
                                                            <li id="list_adresse" class="ui-state-default"><i
                                                                    class="fa fa-cube"></i> <b>Adresse</b>
                                                            </li>

                                                        {% elseif col == "cumuldon" %}
                                                            <li id="list_cumuldon" class="ui-state-default"><i
                                                                    class="fa fa-cube"></i> <b>Cumul des dons</b>
                                                            </li>

                                                        {% elseif col == "ville" %}
                                                            <li id="list_ville" class="ui-state-default"><i
                                                                    class="fa fa-cube"></i> <b>Ville</b>
                                                            </li>
                                                        {% elseif col == "pays" %}
                                                            <li id="list_pays" class="ui-state-default"><i class="fa fa-cube"></i>
                                                                <b>Pays</b>
                                                            </li>
                                                        {% elseif col == "zipcode" %}

                                                            <li id="list_zipcode" class="ui-state-default"><i class="fa fa-cube"></i>
                                                                <b>Code postal</b>
                                                            </li>
                                                        {% elseif col == "createdat" %}
                                                            <li id="list_createdat" class="ui-state-default"><i class="fa fa-cube"></i>
                                                                <b>Date de creation </b>
                                                            </li>
                                                        {% endif %}
                                                    {% endfor %}
                                                </ul>
                                            </div>

                                        </div>
                                        <!-- /section:plugins/input.chosen -->
                                    </div>
                                </div>
                            </div>

                            <br>

                            <button type="button" data-toggle="modal" data-target="#add_de_enregistrement_popup" class="btn btn-success" style="width: 240px;"  id="add_de">
                                <i class="fa fa-plus"></i> Sauvegarder ce DE <i class="ace-icon"></i>
                            </button>
                        </div>
                        <!-- /.span -->

                    </div>

                    {{ form_rest(form) }}
                    </form>
                    {#{dump(form_cumule_don)}#}


                </div>


                <div class="tab-pane {% if total_donateur > 0  %}active{% endif %} " id="result">
                    <br/>

                    <table class="table table-condensed" id="liste_search_donateur">
                        <thead>
                            <tr>
                                {% for col in col_display %}
                                    {% set sortcols = { 'numdonateur':'#REF','nom':'Nom','prenom':'Prénom','statut':'Statut',
                            'nomentreprise':'Nom d\'entreprise','email':'Email','birthday':'Date de naissance',
                             'telmobile':'Téléphone mobile','telfixe':'Téléphone fixe',
                             'adresse':'Adresse','cumuldon':'Cumul des dons','ville':'Ville','pays':'Pays','zipcode':'Code postal','createdat':'Date de création'} %}
                                    {% set cols = { 'numdonateur':'#REF','nom':'Nom','prenom':'Prénom','statut':'Statut',
                            'nomentreprise':'Nom d\'entreprise','email':'Email','birthday':'Date de naissance',
                             'telmobile':'Téléphone mobile','telfixe':'Téléphone fixe','cat':'Catégories',
                             'adresse':'Adresse','cumuldon':'Cumul des dons','ville':'Ville','pays':'Pays','zipcode':'Code postal','createdat':'Date de création'} %}
                                    {% if col in cols|keys %}
                                        <th>{{ cols[col] }} 
                                            {% if col in sortcols|keys %} 
                                                <!--a href="#" onclick="flipsort('{#{ col }#}')" class="pull-right sort" ><i id="sort_{#{ col }#}" class="{#% if col == sortelement %}{% if sortdirection == 'desc' %}fa fa-lg fa-sort-desc{% else %}fa fa-lg fa-sort-asc{% endif %#}{#% else %}fa fa-lg fa-sort{% endif %#}"></i-->
                                                <a href="#" class="pull-right sort" >
                                                    <!--i id="sort_{#{ col }#}" class="{#% if col == sortelement %}{% if sortdirection == 'desc' %}fa fa-lg fa-sort-desc{% else %}fa fa-lg fa-sort-asc{% endif %#}{#% else %}fa fa-lg fa-sort{% endif %#}">
                                                    </i-->
                                                </a>
                                                {#{dump(cols[col])}#}

                                            {% endif %}
                                        </th>
                                    {% endif %}
                                {% endfor %}
                                <th></th>
                            </tr>
                            <tr>
                                {% for col in col_display %}
                                    {% if col == "cat" %}
                                        <th> 
                                            <select id="categorie_dropdawn"  class="task_field form-control input-sm">
                                                <option></option>
                                                {% for categorie in categories %}
                                                    <option value="{{categorie.Id}}">{{categorie.Name}}</option>
                                                {% endfor %}
                                            </select>
                                        </th>
                                    {% elseif col == "numdonateur" %}
                                        <th> 

                                        </th>

                                    {% elseif col == "nom" %}
                                        <th> 

                                        </th>

                                    {% elseif col == "prenom" %}
                                        <th> 

                                        </th>
                                    {% elseif col == "telfixe" %}
                                        <th> 

                                        </th>
                                    {% elseif col == "adresse" %}
                                        <th> 

                                        </th>
                                    {% elseif col == "cumuldon" %}
                                        <th> 

                                        </th>
                                    {% elseif col == "ville" %}
                                        <th> 

                                        </th>
                                    {% elseif col == "zipcode" %}
                                        <th> 

                                        </th>

                                    {% elseif col == "email" %}
                                        <th> 

                                        </th>
                                    {% elseif col == "telmobile" %}
                                        <th> 

                                        </th>
                                    {% elseif col == "createdat" %}
                                        <th> 

                                        </th>
                                    {% elseif col == "birthday" %}
                                        <th> 

                                        </th>
                                    {% elseif col == "statut" %}
                                        <th> 

                                        </th> 
                                    {% elseif col == "pays" %} 
                                        <th> 
                                            <select id="pays_dropdawn"  class="task_field form-control input-sm">
                                                <option></option>
                                                {% for pay in pays %}
                                                    <option value="{{pay.Id}}">{{pay.Name}}</option>
                                                {% endfor %}
                                            </select>
                                        </th>
                                    {% elseif col ==  "nomentreprise" %}
                                        <th>
                                            <input type="text" id="entreprise_dropdawn"  class="task_field form-control input-sm">
                                        </th>


                                    {% endif %}
                                {% endfor %}
                                <th>
                                    <div>
                                        <a id="btn_modification_masse" class="btn btn-xs btn-default" data-toggle="modal" data-target="#addpopup-modification_masse" href="#">
                                            <span class="glyphicon glyphicon-edit"></span>
                                            Modification en Masse 
                                        </a>  

                                    </div> 
                                </th>
                            </tr>


                        </thead>

                        <tbody id="content">
                            {% for r in result %}
                                {#% if r.removed == false %#}
                                <tr id="id_donateur_{{r.id}}">
                                    {% for col in col_display %}
                                        {% if col == "numdonateur" %}
                                            <td>{{ r.refDonateur }}</td>
                                        {% elseif col ==  "nom" %}
                                            <td>{{ r.nom }}</td>
                                        {% elseif col == "prenom" %}
                                            <td>{{ r.prenom }}</td>
                                        {% elseif col == "statut" %}
                                            <td> {% if r.removed %}<span
                                                    class="label label-danger arrowed-in arrowed-in-right">Désactivé</span> {% else %}
                                                <span class="label label-success arrowed-in arrowed-in-right">Actif</span>{% endif %}
                                            </td>
                                        {% elseif col == "nomentreprise" %}
                                            <td>{% if r.nomEntreprise is defined and r.nomEntreprise is not null %}{{ r.nomEntreprise }}{% else %} N/A{% endif %}</td>
                                        {% elseif col == "email" %}
                                            <td>{{ r.email }}</td>
                                        {% elseif col == "birthday" %}
                                            <td>{{ r.dateNaissance|date('d/m/Y') }}</td>
                                        {% elseif col == "telmobile" %}
                                            <td>{{ r.telephoneMobile }}</td>
                                        {% elseif col == "telfixe" %}
                                            <td>{{ r.telephoneFixe }}</td>
                                        {% elseif col == "cat" %}
                                            <td><ul>
                                                    {% for cat in r.categories %}
                                                        <li id="id_categorie_{{cat.id}}">{{ cat.name }}</li>
                                                        {% endfor %}
                                                </ul></td>
                                            {% elseif col == "adresse" %}
                                            <td>{{ r.adresse3 }}</td>
                                        {% elseif col == "ville" %}

                                            <td>{{ r.isoville }}</td>
                                        {% elseif col == "pays" %}
                                            <td>{{ r.isopays|getcountryname }}</td>
                                            {#{ r.isopays|getcountryname }#}
                                        {% elseif col == "zipcode" %}
                                            <td>{{ r.zipcode }}</td>
                                        {% elseif col == "createdat" %}
                                            <td>{{ r.createdAt|date('d/m/Y') }}</td>

                                        {% elseif col == "cumuldon" %}
                                            {% for calcul in calcul_cumul_donateur %}
                                                {% if calcul['donateur_id'] == r.id %}
                                                    <td>{{calcul['cumul']}}</td>
                                                {% endif %}
                                            {% endfor %}
                                        {% endif %}
                                    {% endfor %}
                                    <td><a href="{{ path('intersa_donateur_gestion',{'id':r.id,'cumul':cumul|round(2, 'floor'),'date':date}) }}" class="btn btn-default btn-xs"><span
                                                class="glyphicon glyphicon-wrench"></span>&nbsp; Gestion</a></td>

                                </tr>
                                {#% endif %#}
                            {% endfor %}
                        </tbody>

                    </table>

                    <center>
                        {% if last_page > 1 %}
                            {% set state = '' %}
                            <ul class="pagination pull-center">
                                {% if result2.hasPreviousPage %}
                                    {% set state = 'paginate_button first' %}
                                    <li class="{{ state }}">
                                        <a href="{{ path('elastic_donateur') }}?{{ params }}&page={{ result2.getCurrentPage() -1 }}" style="cursor: pointer">&laquo;&nbsp;{{ 'Précédent'|trans }}</a>

                                    </li>
                                {% else %}
                                    <li class="disabled">
                                        <span>&laquo;&nbsp;{{ 'Précédent'|trans }}</span>
                                    </li>
                                {% endif %}
                                <!--li><a href="{#{ path('elastic_donateur') }}?{{ params }}&page={{ previous_page }#}">&laquo;</a>
                                </li-->
                                {% for page in 1..last_page %}
                                    {% if page >= current_page-4 and page <= current_page+4 %}
                                        {% if   page == current_page-4 or page == current_page+4 %}
                                            {% if   page == current_page-4 %}
                                                <li><a href="{{ path('elastic_donateur') }}?{{ params }}&page=1">1</a></li>
                                                <li class="disabled"><a href="#">...</a></li>
                                                {% else %}
                                                <li class="disabled"><a href="#">...</a></li>
                                                <li>
                                                    <a href="{{ path('elastic_donateur') }}?{{ params }}&page={{ last_page }}">{{ last_page }}</a>
                                                </li>
                                            {% endif %}
                                        {% else %}
                                            {% if page == current_page %}
                                                <li class="active"><a href="#">{{ page }}</a></li>
                                                {% else %}
                                                <li>
                                                    <a href="{{ path('elastic_donateur') }}?{{ params }}&page={{ page }}">{{ page }}</a>
                                                </li>
                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                                {% set state = '' %}
                                {% if result2.hasNextPage %}
                                    <li class="{{ state }}" ><a href="{{ path('elastic_donateur') }}?{{ params }}&page={{ result2.getCurrentPage() +1}}" style="cursor: pointer">{{ 'Suivant'|trans }}&nbsp;&raquo;</a></li>
                                    {% else %}
                                    <li class="disabled">
                                        <span>&laquo;&nbsp;{{ 'Suivant'|trans }}</span>
                                    </li>
                                {% endif %}
                                <!--li><a href="{#{ path('elastic_donateur') }}?{{ params }}&page={{ next_page }#}">&raquo;</a></li-->
                            </ul>
                        {% endif %}
                    </center>

                </div>
                <br/>




                <div id="result_search_don" class="tab-pane">
                    <div  id="frm_cumule_don" style="margin-top: -61px;">
                        <br>
                        {% include "FulldonIntersaBundle:Donateurs:partial_cumul_don.html.twig" %}
                        <input type="hidden" id="hiden_date_min"/>
                        <input type="hidden" id="hiden_date_max"/>
                        <input type="hidden" id="hiden_mt_min"/>
                        <input type="hidden" id="hiden_mt_max"/>
                        <input type="hidden" id="hiden_mail_donateur"/>

                    </div>

                    <div  id="ligne_cumul_don" style="display: block">
                        {% include "FulldonIntersaBundle:Donateurs:ligne_cumul_don.html.twig" with {'coldisplay_ligne_cumule_don': coldisplay_ligne_cumule_don} %} 
                    </div>

                </div>





                <div id="result_search_de" class="tab-pane">

                    <div  id="ligne_de_enregister" style="display: block">
                        {% include "FulldonIntersaBundle:Donateurs:ligne_de_enregister.html.twig" with {'coldisplay_ligne_de_enregister': coldisplay_ligne_de_enregister} %} 
                    </div>

                </div> 





            </div>
    </div>
    <!-- Modal -->

    <!------------------------ Begin POPUP DELETE  -------------------------------------------->
    <div class="modal fade" id="delete_popup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel" style="color: #B30E2B;font-size: 25px;font-weight: bold;font-style: italic">Suppression</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <p style="font-size: 20px;font-weight: bold;font-style: italic;">Vous êtes  entrain de supprimer un dessin.</p>
                            <p style="font-size: 20px;font-weight: bold;font-style: italic;">Voulez-vous Continuer  ?</p>
                            <p class="debug-url"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn_annuler_delete" type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
                <button id="btn_confirm_delete_popup" onclick="PopUpDeleteDessin()" type="button" class="btn btn-primary">Valider</button>
            </div>
        </div>
    </div>
</div>

<!------------------------ End POPUP DELETE -------------------------------------------->

<!------------------------ Start POPUP Sauvgarde Dessin Enregistrement -------------------------------------------->

<div class="modal fade" id="add_de_enregistrement_popup" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Enregistrer ce dessin</h4>
            </div>
            <form id="frm_popup_dessin" action ="{{path('intersa_donateur_dessin_add')}}" method="GET" >
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <label class=" control-label">Titre du dessin</label>
                            <input id="titre_de_popup" class="form-control" name="title_de" required="required"/>
                            <br/>
                            <label class=" control-label">Description du dessin</label>
                            <textarea id="description_de_popup" name="description_de" class="form-control"></textarea>
                            <!--input id="columns_de_popup" class="form-control" name="columns_de" required="required" type="hidden"
                                 value="{#{ params }#}" readonly="readonly"  /-->

                            <input id="columns_de_popup" class="form-control" name="columns_de" required="required" type="hidden"
                                   value="{#{ params }#}" readonly="readonly"  />
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="btn_popup_annuler_de" type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
                    <button id="btn_popup_sauvgarde_de" type="button" class="btn btn-primary">Sauvegarder le dessin</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!------------------------ END POPUP Sauvgarde Dessin Enregistrement -------------------------------------------->
<!------------------------ Start POPUP Sauvgarde Ajouter cette selection -------------------------------------------->
<div class="modal fade" id="addRecherche" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Ajouter cette recherche aux favoris</h4>
            </div>
            <form action="{{ path('intersa_donateur_favoris_add', {'section': 'donateurs'}) }}" method="POST">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <label class=" control-label">Titre de la recherche</label>
                            <input class="form-control" name="title" required="required"/>
                            <br/>
                            <label class=" control-label">Description de la recherche</label>
                            <textarea name="description" class="form-control"></textarea>
                            <input id="url" class="form-control" name="url" required="required" type="hidden"
                                   value="{{ params }}" readonly="readonly"/>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-primary">Sauvegarder la recherche</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!------------------------ END POPUP Sauvgarde Ajouter cette selection -------------------------------------------->
<!------------------------ Start POPUP Sauvgarde Critere Recherche -------------------------------------------->
<div class="modal fade" id="addSauvgardeCritere" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Ajouter cette selection</h4>
            </div>
            <form action="{{ path('intersa_critere_recherche_add', {'section': 'donateurs'}) }}" method="POST">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <label class=" control-label">Titre de la selection</label>
                            <input class="form-control" name="title" required="required"/>
                            <br/>
                            <label class=" control-label">Description de la selection</label>
                            <textarea name="description" class="form-control"></textarea>
                            <input id="url" class="form-control" name="url" required="required" type="hidden"
                                   value="{{ params }}" readonly="readonly"/>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-primary">Sauvegarder</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--------------------------------- End POPUP Sauvgarde Critere Recherche --------------------------------------->


<!------------------------ Start POPUP Modification en Masse -------------------------------------------->
<div class="modal fade" id="addpopup-modification_masse" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Modification en Masse</h4>
            </div>
            <form action="" method="GET">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <label class=" control-label" style="font-size: 20px">voulez-vous vraiment  &nbsp&nbsp  exécuter cette tache ??</label>
                            <br/>
                            <label class=" control-label"> </label>
                            <br/>

                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
                    <button id="valider_modif_masse_popup" type="button" class="btn btn-primary">Valider</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--------------------------------- End POPUP Modification en Masse --------------------------------------->




<div class="modal fade" id="listRecherche" tabindex="-1" role="dialog" aria-labelledby="listRecherche"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="listRechercheLabel">Liste des favoris</h4>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <table class="table table-hover">
                            <thead>
                            <th>Informations sur la recherche</th>
                            <th>Actions</th>
                            </thead>
                            <tbody>
                                {% for f in favoris %}
                                    <tr>
                                        <td>{{ f.title }}<br/><span
                                                style="font-size: 10px;">{{ f.description }}</span></td>
                                        <td>
                                            <div class="btn-group">
                                                <button type="button" class="btn btn-xs btn-default dropdown-toggle"
                                                        data-toggle="dropdown" aria-expanded="false">
                                                    Actions <span class="caret"></span>
                                                </button>
                                                <ul class="dropdown-menu" role="menu">
                                                    <li><a href="{{ path('elastic_donateur') }}?{{ f.url }}"
                                                           target="_blank"><i class="fa fa-search"></i> Lancer la
                                                            recherche</a></li>
                                                    <li>
                                                        <a href="{{ path('intersa_donateur_favoris_delete', {'id': f.id}) }}"><i
                                                                class="fa fa-trash-o"></i> Supprimer la
                                                            recherche</a></li>
                                                </ul>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    {% javascripts '../app/Resources/Public/js/jquery-ui/jquery-ui.js' %}
    <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}
    <script>



        $(document).ready(function () {

            $("#fulldon_donateurbundle_donateursearchtype_refDonateur").keyup(function () {

                var id_donateur = $("#fulldon_donateurbundle_donateursearchtype_refDonateur").val();
                $("#fulldon_donateurbundle_doncumulesearchtype_refDonateur").val(id_donateur);
                //alert($("#fulldon_donateurbundle_doncumulesearchtype_refDonateur").val());
            });//serach_btn_elastic_don





            $("#serach_btn_elastic_don").click(function () {
                $('#li_recherche_formulaire').removeClass('active');
                $('#li_result_recherche_donateur').removeClass('active');
                $('#li_result_rechreche_don').addClass('active');
                $('#li_result_rechreche_de').addClass('active');
                $('#result_search_don').css('display', 'block');


                var date_min_c = $("#fulldon_donateurbundle_doncumulesearchtype_DateMinDon").val();
                var date_max_c = $("#fulldon_donateurbundle_doncumulesearchtype_DateMaxDon").val();
                var montant_min_c = $("#fulldon_donateurbundle_doncumulesearchtype_MtMinDon").val();
                var montant_max_c = $("#fulldon_donateurbundle_doncumulesearchtype_MtMaxDon").val();
                var emailDonateur_c = $("#fulldon_donateurbundle_doncumulesearchtype_emailDonateur").val();
                $("#hiden_date_min").val(date_min_c);
                $("#hiden_date_max").val(date_max_c);
                $("#hiden_mt_min").val(montant_min_c);
                $("#hiden_mt_max").val(montant_max_c);
                $("#hiden_mail_donateur").val(emailDonateur_c);

                //$("#main_tab_content").html($('#result_search_don').html());


                var url = $("#frm_cumul_don").attr("action");
                var form = $('#frm_cumul_don').serialize();
                $.ajax({
                    url: url,
                    type: "POST",
                    data: form,
                    //contentType: "application/json; charset=utf-8",
                    //dataType: "json",
                    cache: false,
                    success: function (data)
                    {
                        console.log(data);
                        //console.log(data.responseText);


                    },
                    complete: function (com) {
                        //console.log(com.responseText);
                        console.log(com);
                        //alert(com.responseText);
                        $('#recherche').removeClass('tab-pane active');
                        $('#recherche').addClass('tab-pane');
                        $('#result').removeClass('tab-pane active');
                        $('#result').addClass('tab-pane');
                        $("#result_search_don").css('display', 'block');
                        //$('#result_search_don').addClass('tab-pane active');
                        $('#result_search_don').addClass('tab-pane active');
                        $("#ligne_cumul_don").html(com.responseText);



                    },
                    error: function (err) {
                        console.log(err);
                        //alert('err');
                    }
                });





            });
            $("#li_result_rechreche_de").click(function () {
                $('#result_search_don').css('display', 'none');
                $('#li_recherche_formulaire').removeClass('active');
                $('#li_result_recherche_donateur').removeClass('active');
                $('#li_result_rechreche_don').removeClass('active');
                $('#li_result_rechreche_de').addClass('active');

                //tab-pane active
                $('#recherche').removeClass('tab-pane active');
                $('#recherche').addClass('tab-pane');
                $('#result').removeClass('tab-pane active');
                $('#result').addClass('tab-pane');
                $('#result_search_don').removeClass('tab-pane active');
                $('#result_search_don').addClass('tab-pane');
                $('#result_search_de').addClass('tab-pane active');



                $("#reset_elastic_donateur").css('display', 'none');
                $("#serach_btn_elastic_donateur").css('display', 'none');
                $("#nbr_donateur").css('display', 'none');
                $("#serach_btn_elastic_don").css('display', 'none');

                var url = "{{ path('intersa_donateur_dessin_get_all') }}";

                $.ajax({
                    url: url,
                    type: "GET",
                    data: '',
                    //contentType: "application/json; charset=utf-8",
                    //dataType: "json",
                    cache: false,
                    success: function (data)
                    {
                        console.log(data);
                        //console.log(data.responseText);


                    },
                    complete: function (com) {
                        //console.log(com.responseText);
                        console.log(com);
                        //alert(com.responseText);
                        //$('#recherche').removeClass('tab-pane active');
                        //$('#recherche').addClass('tab-pane');
                        //$('#result').removeClass('tab-pane active');
                        //$('#result').addClass('tab-pane');
                        //$('#result_search_de').addClass('tab-pane active');
                        //alert(com.responseText);
                        $("#ligne_de_enregister").html(com.responseText);



                    },
                    error: function (err) {
                        console.log(err);
                        //alert('err');
                    }
                });










            });
            $("#li_result_rechreche_don").click(function () {

                //$('#page_navigation1').addClass('red-class');
                $('#result_search_don').css('display', 'block');
                $('#li_recherche_formulaire').removeClass('active');
                $('#li_result_recherche_donateur').removeClass('active');
                $('#li_result_rechreche_de').removeClass('active');
                $('#li_result_rechreche_don').addClass('active');

                //tab-pane active
                $('#recherche').removeClass('tab-pane active');
                $('#recherche').addClass('tab-pane');
                $('#result').removeClass('tab-pane active');
                $('#result').addClass('tab-pane');
                $('#result_search_de').removeClass('tab-pane active');
                $('#result_search_de').addClass('tab-pane');
                $('#result_search_don').addClass('tab-pane active');

                //$("#main_tab_content").html($('#result_search_don').html());
                // btn visualitation
                //$("#add_donateur").css('display', 'none');
                // $("#gestion_favoris_donateur").css('display', 'none');
                $("#reset_elastic_donateur").css('display', 'none');
                $("#serach_btn_elastic_donateur").css('display', 'none');
                //$("#div_description").css('display', 'none');
                $("#nbr_donateur").css('display', 'none');
                $("#serach_btn_elastic_don").css('display', 'block');

            });
            $("#li_result_recherche_donateur").click(function () {
                $('#li_recherche_formulaire').removeClass('active');
                $('#li_result_rechreche_don').removeClass('active');
                $('#li_result_rechreche_de').removeClass('active');
                $('#li_result_recherche_donateur').addClass('active');
                $('#result').removeClass('tab-pane');
                $('#result').addClass('tab-pane active');
                $('#recherche').removeClass('tab-pane active');
                $('#recherche').addClass('tab-pane');
                $('#result_search_don').removeClass('tab-pane active');
                $('#result_search_don').addClass('tab-pane');
                $('#result_search_de').removeClass('tab-pane active');
                $('#result_search_de').addClass('tab-pane');


                // btn visualitation
                //$("#add_donateur").css('display', 'block');
                //$("#gestion_favoris_donateur").css('display', 'block');
                $("#reset_elastic_donateur").css('display', 'block');
                $("#serach_btn_elastic_donateur").css('display', 'block');
                $("#div_description").css('display', 'block');
                $("#nbr_donateur").css('display', 'block');
                $("#serach_btn_elastic_don").css('display', 'none');





            });
            $("#li_recherche_formulaire").click(function () {
                //window.location.reload();

                $('#li_result_recherche_donateur').removeClass('active');
                $('#li_result_rechreche_don').removeClass('active');
                $('#li_result_rechreche_de').removeClass('active');
                $('#li_recherche_formulaire').addClass('active');
                $('#recherche').removeClass('tab-pane');
                $('#recherche').addClass('tab-pane active');
                $('#result').removeClass('tab-pane active');
                $('#result').addClass('tab-pane');
                $('#result_search_don').removeClass('tab-pane active');
                $('#result_search_don').addClass('tab-pane');
                $('#result_search_de').removeClass('tab-pane active');
                $('#result_search_de').addClass('tab-pane');

                // btn visualitation
                //$("#add_donateur").css('display', 'block');
                //$("#add_donateur").css('style', 'margin-left: 184px;margin-bottom: -28px;');
                //$("#gestion_favoris_donateur").css('display', 'block');
                $("#reset_elastic_donateur").css('display', 'block');
                $("#serach_btn_elastic_donateur").css('display', 'block');
                $("#div_description").css('display', 'block');
                $("#nbr_donateur").css('display', 'block');
                $("#serach_btn_elastic_don").css('display', 'none');




            });



            //btn_popup_annuler_de
            $("#btn_popup_annuler_de").click(function () {
                $('#titre_de_popup').val('');
                $('#description_de_popup').val('');
            });

            // btn_popup_sauvgarde_de
            $("#btn_popup_sauvgarde_de").click(function () {
                var columns = $('#columns').val();
                $("#columns_de_popup").val(columns);
                var url = "{{ path('intersa_donateur_dessin_add') }}";
                var formSerialize = $("#frm_popup_dessin").serialize();
                $.ajax({
                    url: url,
                    type: 'GET',
                    cahce: false,
                    //data: "param1=" + titre_de + "&param2=" + description_de + "&param3=" + columns_de,
                    data: formSerialize,
                    beforeSend: function () {
                    },
                    success: function (data) {
                        console.log('success');
                        console.log(data);
                        // $("#loading-ajax_typepret").css('display', 'none');
                        //$("#").html(data);
                    },
                    complete: function (comp)
                    {
                        console.log('complete');//
                        console.log(comp);
                        if (comp.responseText === 'success') {
                            var message = 'Dessin enregistrée avec succée';
                            $("#msg_success").html(message);
                            $("#msg_success").css('display', 'block');
                            setTimeout(function () {
                                $('#msg_success').hide("slow");
                            }, 3000);
                        }

                        if (comp.responseText === 'erreur') {
                            var message = 'Erreur de sauvegarde du déssin';
                            $("#msg_erreur").html(message);
                            $("#msg_erreur").css('display', 'block');
                            setTimeout(function () {
                                $('#msg_erreur').hide("slow");
                            }, 3000);
                        }


                        //$('#result_search_don').addClass('tab-pane active');
                        //$("#ligne_cumul_don").html(comp.responseText);


                    },
                    error: function (err) {
                        console.log(err);
                        console.log('err');

                    }
                });

                $("#btn_popup_annuler_de").trigger("click");
            });

            //active desactive menu export exel
            var html = $("#liste_search_donateur tbody tr").html();
            var state = 'disabled';
            if (html === undefined) {
                $("#li_donateur_exel").addClass(state);
            } else {
                //state = "active";
                $("#li_donateur_exel").removeClass(state);

            }





        });





        function paginateCumulDon(page, montant_min, montant_max, date_min, date_max, email_donateur) {

            var url = "{{path('elastic_cumule_don_by_donateur')}}";
            $.ajax({
                url: url,
                type: 'GET',
                cahce: false,
                data: "param=" + page + "&param1=" + $("#hiden_mt_min").val() + "&param2=" + $("#hiden_mt_max").val() + "&param3=" + $("#hiden_date_min").val() + "&param4=" + $("#hiden_date_max").val() + "&param5=" + $("#hiden_mail_donateur").val(),
                beforeSend: function () {
                },
                success: function (data) {
                    console.log('success');
                    console.log(data);
                    // $("#loading-ajax_typepret").css('display', 'none');
                    //$("#").html(data);
                },
                complete: function (comp)
                {
                    console.log('complete');//
                    console.log(comp);//
                    $('#result_search_don').addClass('tab-pane active');
                    $("#ligne_cumul_don").html(comp.responseText);


                },
                error: function (err) {
                    console.log(err);
                    console.log('err');

                }
            });
        }


        function paginateDessin(page) {

            var url = "{{path('intersa_donateur_paginate_dessin')}}";
            $.ajax({
                url: url,
                type: 'GET',
                cahce: false,
                data: "param=" + page,
                beforeSend: function () {
                },
                success: function (data) {
                    console.log('success');
                    console.log(data);
                    // $("#loading-ajax_typepret").css('display', 'none');
                    //$("#").html(data);
                },
                complete: function (comp)
                {
                    console.log('complete');//
                    console.log(comp);//
                    $('#result_search_de').addClass('tab-pane active');
                    $("#ligne_de_enregister").html(comp.responseText);


                },
                error: function (err) {
                    console.log(err);
                    console.log('err');

                }
            });
        }

        function Init() {
            $("#columns").val('');
            $("#sortable2").html('');
            $("#sortable1").html('');
            // debut init columns
            //$("#columns").val('list[]=numdonateur&list[]=nom&list[]=prenom&list[]=nomentreprise&list[]=statut');
            // end init columns
            // debut init sortable1
            $("#sortable1").append('<li id="list_ville" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Ville</b></li>');
            $("#sortable1").append('<li id="list_pays" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Pays</b></li>');
            $("#sortable1").append('<li id="list_zipcode" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Code postal</b></li>');
            $("#sortable1").append('<li id="list_birthday" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Date de naissance</b></li>');
            $("#sortable1").append('<li id="list_email" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Email</b></li>');
            $("#sortable1").append('<li id="list_telmobile" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Téléphone mobile</b></li>');
            $("#sortable1").append('<li id="list_telfixe" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Téléphone fixe</b></li>');
            $("#sortable1").append('<li id="list_createdat" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Date de creation</b></li>');
            $("#sortable1").append('<li id="list_cat" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Catégories</b></li>');
            $("#sortable1").append('<li id="list_adresse" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Adresse</b></li>');
            $("#sortable1").append('<li id="list_cumuldon" class="ui-state-default ui-sortable-handle"><i class="fa fa-cube"></i> <b>Cumul des dons</b></li>');
            // end init sortable1


        }

        function consulterDessinER(id) {



            var url = "{{ path('intersa_donateur_find_dessin') }}";
            $.ajax({
                url: url,
                type: "GET",
                data: "param=" + id,
                //contentType: "application/json; charset=utf-8",
                //dataType: "json",
                cache: false,
                success: function (data)
                {
                    console.log('data');
                    console.log(data);

                },
                complete: function (com) {
                    console.log('com');
                    console.log(com);
                    Init();
                    var jsonData = JSON.parse(com.responseText);
                    for (var i = 0; i < jsonData.tab.length; i++) {
                        var tab = jsonData.tab[i];
                        if ((typeof tab.numdonateur !== 'undefined') && (tab.numdonateur === 'numdonateur')) {

                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=numdonateur');
                            $('[id="list_numdonateur"]').remove();
                            $("#sortable2").append('<li id="list_numdonateur" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Numéro du donateur</b></li>');
                        }
                        if ((typeof tab.nom !== 'undefined') && (tab.nom === 'nom')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=nom');
                            $('[id="list_nom"]').remove();
                            $("#sortable2").append('<li id="list_nom" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Nom</b></li>');
                        }
                        if ((typeof tab.prenom !== 'undefined') && (tab.prenom === 'prenom')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=prenom');
                            $('[id="list_prenom"]').remove();
                            $("#sortable2").append('<li id="list_prenom" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Prénom</b></li>');
                        }
                        if ((typeof tab.nomentreprise !== 'undefined') && (tab.nomentreprise === 'nomentreprise')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=nomentreprise');
                            $('[id="list_nomentreprise"]').remove();
                            $("#sortable2").append('<li id="list_nomentreprise" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Nom entreprise</b></li>');
                        }
                        if ((typeof tab.statut !== 'undefined') && (tab.statut === 'statut')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=statut');
                            $('[id="list_statut"]').remove();
                            $("#sortable2").append('<li id="list_statut" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Statut</b></li>');
                        }
                        if ((typeof tab.ville !== 'undefined') && (tab.ville === 'ville')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=ville');
                            $('[id="list_ville"]').remove();
                            $("#sortable2").append('<li id="list_ville" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Ville</b></li>');
                        }
                        if ((typeof tab.pays !== 'undefined') && (tab.pays === 'pays')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=pays');
                            $('[id="list_pays"]').remove();
                            $("#sortable2").append('<li id="list_pays" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Pays</b></li>');
                        }
                        if ((typeof tab.zipcode !== 'undefined') && (tab.zipcode === 'zipcode')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=zipcode');
                            $('[id="list_zipcode"]').remove();
                            $("#sortable2").append('<li id="list_zipcode" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Code postal</b></li>');
                        }
                        if ((typeof tab.birthday !== 'undefined') && (tab.birthday === 'birthday')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=birthday');
                            $('[id="list_birthday"]').remove();
                            $("#sortable2").append('<li id="list_birthday" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Date de naissance</b></li>');
                        }
                        if ((typeof tab.email !== 'undefined') && (tab.email === 'email')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=email');
                            $('[id="list_email"]').remove();
                            $("#sortable2").append('<li id="list_email" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Email</b></li>');
                        }
                        if ((typeof tab.telmobile !== 'undefined') && (tab.telmobile === 'telmobile')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=telmobile');
                            $('[id="list_telmobile"]').remove();
                            $("#sortable2").append('<li id="list_telmobile" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Téléphone mobile</b></li>');
                        }
                        if ((typeof tab.telfixe !== 'undefined') && (tab.telfixe === 'telfixe')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=telfixe');
                            $('[id="list_telfixe"]').remove();
                            $("#sortable2").append('<li id="list_telfixe" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Téléphone fixe</b></li>');
                        }
                        if ((typeof tab.createdat !== 'undefined') && (tab.createdat === 'createdat')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=createdat');
                            $('[id="list_createdat"]').remove();
                            $("#sortable2").append('<li id="list_createdat" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Date de creation</b></li>');
                        }
                        if ((typeof tab.cat !== 'undefined') && (tab.cat === 'cat')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=cat');
                            $('[id="list_cat"]').remove();
                            $("#sortable2").append('<li id="list_cat" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Catégories</b></li>');
                        }
                        if ((typeof tab.adresse !== 'undefined') && (tab.adresse === 'adresse')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=adresse');
                            $('[id="list_adresse"]').remove();
                            $("#sortable2").append('<li id="list_adresse" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Adresse</b></li>');
                        }
                        if ((typeof tab.cumuldon !== 'undefined') && (tab.cumuldon === 'cumuldon')) {
                            var columns_old = $("#columns").val();
                            $("#columns").val('');
                            $("#columns").val(columns_old + '&list[]=cumuldon');
                            $('[id="list_cumuldon"]').remove();
                            $("#sortable2").append('<li id="list_cumuldon" class="ui-state-highlight ui-sortable-handle"><i class="fa fa-cube"></i> <b>Cumul des dons</b></li>');
                        }

                    }
                },
                error: function (err) {
                    console.log(err);
                    //alert('err');
                }
            });
            $("#li_recherche_formulaire").trigger("click");



        }


        $("#btn_annuler_delete").click(function () {
            id_ligne_de_delete = "";
            //window.location.reload();
            $("#li_result_rechreche_de").trigger("click");

        });

        $("#btn_generate_donateur_exel").click(function () {
            var Obj = '';
            $.ajax({
                url: "{{ path('intersa_gestion_donateur_export_exel') }}", //'/intersa/export-dons/exel',
                type: "GET",
                //data: data,
                data: Obj, //{mydata: obj}
                //data: data,
                //data: JSON.stringify(obj3),
                //contentType: "application/json; charset=utf-8",
                //dataType:"json",
                cache: false,
                success: function (data)
                {
                    console.log(data);
                    //alert(data);

                },
                complete: function (com) {
                    //console.log(com.responseText);
                    //alert(com.responseText);
                    console.log(com);



                },
                error: function (err) {
                    console.log(err);
                    //alert('err');
                }
            });


        });
        
         


       



        var id_ligne_de_delete = "";
        function deleteDessinER(id) {
            $('#delete_popup').on('show.bs.modal', function () {
                id_ligne_de_delete = id;

            });
        }
        function PopUpDeleteDessin() {

            if (id_ligne_de_delete != "") {
                var id = id_ligne_de_delete;
                var url = "{{ path('intersa_donateur_dessin_delete') }}";
                $.ajax({
                    url: url,
                    type: "GET",
                    data: "param=" + id,
                    //contentType: "application/json; charset=utf-8",
                    //dataType: "json",
                    cache: false,
                    success: function (data)
                    {
                        console.log('data');
                        console.log(data);

                    },
                    complete: function (com) {
                        console.log('com');
                        console.log(com);
                        if (com.responseText === 'success') {
                            var message = 'Dessin supprimer avec succée';
                            $("#msg_success").html(message);
                            $("#msg_success").css('display', 'block');
                            setTimeout(function () {
                                $('#msg_success').hide("slow");
                            }, 3000);
                        }

                        if (comp.responseText === 'erreur') {
                            var message = 'Erreur de suppression du dessin';
                            $("#msg_erreur").html(message);
                            $("#msg_erreur").css('display', 'block');
                            setTimeout(function () {
                                $('#msg_erreur').hide("slow");
                            }, 3000);
                        }
                        //$("#ligne_de_enregister").html(comp.responseText);
                        //alert(etat);

                    },
                    error: function (err) {
                        console.log(err);
                        //alert('err');
                    }
                });
                $("#btn_annuler_delete").trigger("click");


            }


        }




        $(document).ready(function () {

            if ($('input[type=radio][name=withcat]:checked').val() == 'true') {
                $('#fulldon_donateurbundle_donateursearchtype_categories').prop('disabled', false);
            } else if ($('input[type=radio][name=withcat]:checked').val() == 'false') {
                $('#fulldon_donateurbundle_donateursearchtype_categories').attr('disabled', 'disabled');
            }
            $('input[type=radio][name=withcat]').change(function () {
                if (this.value == 'true') {
                    $('#fulldon_donateurbundle_donateursearchtype_categories').prop('disabled', false);
                } else if (this.value == 'false') {
                    $('#fulldon_donateurbundle_donateursearchtype_categories').attr('disabled', 'disabled');
                }
            });

        });
        $(document).ready(function () {
            if ($('input[type=radio][name=withemail]:checked').val() == 'true') {
                $('#fulldon_donateurbundle_donateursearchtype_email').prop('disabled', false);
            } else if ($('input[type=radio][name=withemail]:checked').val() == 'false') {
                $('#fulldon_donateurbundle_donateursearchtype_email').attr('disabled', 'disabled');
            }
            $('input[type=radio][name=withemail]').change(function () {
                if (this.value == 'true') {
                    $('#fulldon_donateurbundle_donateursearchtype_email').prop('disabled', false);
                } else if (this.value == 'false') {
                    $('#fulldon_donateurbundle_donateursearchtype_email').attr('disabled', 'disabled');
                }
            });
        });


        function validateEmail(email) {
            var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return re.test(email);
        }



        function validate() {

            var email = $("#fulldon_donateurbundle_donateursearchtype_email").val();
            if (validateEmail(email)) {
                $("#div_message_error_mail").css('display', 'block');
                $("#div_message_error_mail").css('background-color', '#f2dede');
                $("#div_message_error_mail").css('border-color', '#ebcccc');
                //$("#div_message_error_mail").css('color', '#a94442');
                $("#div_message_error_mail").css('color', 'green');
                $("#div_message_error_mail").html('Email valid');
            } else {
                $("#div_message_error_mail").css('display', 'block');
                $("#div_message_error_mail").css('background-color', '#f2dede');
                $("#div_message_error_mail").css('border-color', '#ebcccc');
                //$("#div_message_error_mail").css('color', '#a94442');
                $("#div_message_error_mail").css('color', 'red');
                $("#div_message_error_mail").html('Vous devez saisir un email valid');
            }
            return false;
        }

        $("#fulldon_donateurbundle_donateursearchtype_email").bind("blur", validate);
        //$("#fulldon_donateurbundle_donateursearchtype_email").bind("click", validate);



        $('#fulldon_donateurbundle_dontype_abonnement_actif').on('click', function () {
            if ($('#fulldon_donateurbundle_dontype_abonnement_actif').is(':checked')) {
                $('#abo_date').show();
            } else {
                $('#abo_date').hide();
            }
        });
        $(document).ready(function () {

            $.getJSON("/villes/id/" + $("#fulldon_donateurbundle_donateursearchtype_pays").val()).done(function (vj) {
                var options = '';
                for (var i = 0; i < vj.length; i++) {
                    options += '<option value="' + vj[i].id + '">' + vj[i].name + '</option>';
                }
                $("#ville").html(options);
            });
        });
        $("#fulldon_donateurbundle_donateursearchtype_pays").on('change', function () {
            $.getJSON("/villes/id/" + $(this).val()).done(function (vj) {
                var options = '';
                for (var i = 0; i < vj.length; i++) {
                    options += '<option value="' + vj[i].id + '">' + vj[i].name + '</option>';
                }
                $("#ville").html(options);
            });
        });
        $(document).ready(function () {

            $(function () {
                $("#sortable1, #sortable2").sortable({
                    connectWith: ".connectedSortable",
                    update: function () {
                        var order = $('#sortable2').sortable('serialize');
                        var res = order.split("&");
                        for (var i in res) {
                            var formatid = res[i];
                            var myid = formatid.substring(7, formatid.length);
                            $('#list_' + myid).removeClass('ui-state-default');
                            $('#list_' + myid).addClass('ui-state-highlight');
                        }
                        $('#columns').val(order);
                        var orderdisable = $('#sortable1').sortable('serialize');
                        var res = orderdisable.split("&");
                        for (var i in res) {
                            var formatid = res[i];
                            var myid = formatid.substring(7, formatid.length);
                            $('#list_' + myid).addClass('ui-state-default');
                            $('#list_' + myid).removeClass('ui-state-highlight');
                        }
                    }

                }).disableSelection();
            });
        });

        $("#valider_modif_masse_popup").click(function () {
            var arr = [];
            var ArrycategorieId = [];
            $('#liste_search_donateur tbody tr').each(function () {
                var search_id_dona = $(this).attr("id");
                var spli_id = search_id_dona.split('id_donateur_');
                arr.push(spli_id[1]);

            });


            $('#liste_search_donateur tbody tr td ul li').each(function () {
                var search_id_dona = $(this).attr("id");
                var spli_id = search_id_dona.split('id_categorie_');
                // alert(spli_id[1]);
                ArrycategorieId.push(spli_id[1]);

            });




            // var CodePostale = $("#codepostale_dropdawn").val();
            //var TelFixe = $("#telfixe_dropdawn").val();
            var Entreprise = $("#entreprise_dropdawn").val();
            //var Status = $("#status_dropdawn option:selected").text();
            //var Adresse = $("#adresse_dropdawn").val();
            var CategorieId = $("#categorie_dropdawn option:selected").val();
            var PaysId = $("#pays_dropdawn option:selected").val();
            //var VilleId = $("#ville_dropdawn").val();

            var results = {"ligne": [
                    {
                        "entreprise": Entreprise,
                        "categorise_id": CategorieId,
                        "pays_id": PaysId,
                    }], "tab_donateur_id": arr, "tab_oldcategorie_id": ArrycategorieId}


            $.ajax({
                url: "{{ path('modification_masse_donateur') }}", //,
                type: "POST",
                data: JSON.stringify(results),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                cache: false,
                success: function (data)
                {
                    console.log(data);
                    //console.log(data.responseText);


                },
                complete: function (com) {
                    //console.log(com.responseText);
                    console.log(com);
                    //alert(com.responseText);



                },
                error: function (err) {
                    console.log(err);
                    //alert('err');
                }
            });
            $("#addpopup-modification_masse").css('display', 'none');
            window.location.reload();

        });




    </script>
{% endblock %}